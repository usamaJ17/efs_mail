import{g as x,Q as J,T as W,o as n,a as i,d as a,u as t,e as B,F as m,Z as X,b as e,i as Y,t as r,s as g,m as _,p as b,l as f,w as M,A as ee,B as te,j as D}from"./app-BfP6W6E7.js";import{_ as se,I as d,Q as H,B as le,U as oe}from"./AuthenticatedLayout-DhuU0y5t.js";import{_ as ne}from"./InputError-Dao574Dt.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ie={class:"h-[calc(100vh-105px)] bg-transparent relative shadow-md bg-white sm:rounded-lg rounded-xl overflow-y-auto"},ae={class:"px-5 py-4 flex justify-between items-center absolute md:relative"},re={class:"flex space-x-4"},ce={class:"relative group inline-block"},de={class:"px-5 flex items-start md:items-center space-x-2 mt-5 md:mt-0 pl-20 md:pl-5"},ue={class:"text-base md:text-2xl font-bold text-[#1f1f1f]"},pe=e("span",{class:"bg-[#dddddd] px-2 py-[1px] inline-block text-xs rounded-md text-slate-800"},"inbox",-1),me=["onClick"],fe={class:"flex items-start space-x-4"},xe={class:"max-w-[70%]"},he={class:"text-base text-slate-900 font-bold"},_e={key:0,class:"text-sm text-slate-600 flex items-center space-x-1"},be=e("span",null,"to",-1),ve={class:"relative"},ge=["onClick"],ye={key:0,class:"absolute -left-[100px] md:left-0 top-6 bg-slate-50 shadow-lg p-2 border z-40 min-w-80"},we={class:"flex items-start mb-[2px] last:mb-0"},ke=e("span",{class:"w-20 text-end pr-2"},"from:",-1),je={class:"flex items-start mb-[2px] last:mb-0"},Ce=e("span",{class:"w-20 text-end pr-2"},"to:",-1),Fe={class:"flex flex-col"},Te={key:0,class:"flex w-full flex-col"},Me={class:"text-[12px] pb-1 -mt-1"},Se={class:"flex items-start mb-[2px] last:mb-0"},Ie=e("span",{class:"w-20 text-end pr-2"},"date:",-1),Re={class:"flex items-start mb-[2px] last:mb-0"},Le=e("span",{class:"w-20 text-end pr-2"},"subject:",-1),Ue={class:"flex items-start mb-[2px] last:mb-0"},$e=e("span",{class:"w-20 text-end pr-2"},"mailed-by:",-1),Be=["innerHTML"],De={class:"flex items-center space-x-2 shrink-0"},He={class:"text-xs text-slate-600"},Ve={class:"relative group inline-block"},Qe={class:"w-9 h-9 text-gray-600 flex items-center justify-center rounded-full"},Ae={class:"relative group inline-block"},Ne=["onClick"],qe=e("span",{class:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-max px-2 py-1 text-xs text-white bg-gray-800 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300"}," Reply ",-1),Oe={key:0,class:"mt-5 md:pl-16 rk-mailBody"},ze=["innerHTML"],Ee={key:0,class:"mt-7 flex flex-wrap md:grid-cols-3 gap-4"},Ke=["href"],Pe={class:"text-xs max-h-3 overflow-hidden"},Ze={class:"px-5 py-4 mt-4 flex space-x-4"},Ge={key:0,class:"min-h-[100px] px-5 py-4"},Je={class:"flex-auto h-full rounded-2xl shadow-xl"},We={key:0,class:"text-red-400 text-sm mt-1 block flex-none"},Xe={class:"py-2 flex-none relative"},Ye={class:"flex gap-2 my-2"},et=["src"],tt={key:1,class:"flex items-center justify-center flex-col w-[100px] h-[100px] text-center border p-1 rounded-md relative group"},st=["onClick"],lt={class:"text-xs max-h-3 overflow-hidden"},ot={class:"flex gap-2"},nt=e("label",{for:"reply-file-upload",class:"inline-block px-3 py-3 cursor-pointer bg-black text-white rounded-full text-sm text-center mr-2.5 transition duration-500 ease-in-out hover:bg-sky-800 w-[120px]"},"Upload File",-1),it={class:"px-9 py-2 w-[130px] bg-sky-800 text-white rounded-3xl inline-flex items-center gap-1",type:"submit"},at={class:"min-h-[100px] px-5 py-4"},rt={class:"p-3 flex flex-col justify-between gap-0 shadow-xl rounded-2xl"},ct={class:"flex-none"},dt={class:"flex flex-wrap items-center mb-3 gap-2 border-b"},ut=e("span",null,"To:",-1),pt={class:"mx-2 text-xs"},mt=["onClick"],ft={key:0,class:"text-red-400 text-sm mt-1 block flex-none"},xt={class:"flex border-b items-center mb-3"},ht=e("span",null,"Subject:",-1),_t={key:0,class:"text-red-400 text-sm mt-1 block flex-none"},bt={class:"flex-auto h-full"},vt={key:0,class:"text-red-400 text-sm mt-1 block flex-none"},gt={class:"py-2 flex-none relative"},yt={class:"flex gap-2 my-2"},wt=["src"],kt={key:1,class:"flex items-center justify-center flex-col w-[100px] h-[100px] text-center border p-1 rounded-md relative group"},jt=["onClick"],Ct={class:"text-xs max-h-3 overflow-hidden"},Ft={class:"flex gap-2"},Tt=e("label",{for:"file-upload",class:"inline-block px-3 py-3 cursor-pointer bg-black text-white rounded-full text-sm text-center mr-2.5 transition duration-500 ease-in-out hover:bg-sky-800 w-[120px]"},"Upload File",-1),Lt={__name:"Show",props:{email:Object},setup(y){const h=y,v=x(!1),w=x(!1),V=()=>{o.reset(),v.value=!v.value,v.value&&(w.value=!1)},Q=J(),S=x(""),F=x(""),j=x(null),o=W({receivers:[],subject:"",sender_id:Q.props.auth.user.id,reply_to:null,content:"",message:"",files:[]}),I={module:le},R=[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike","blockquote"],[{align:[]}],[{list:"ordered"},{list:"bullet"}],["link"]],L=x(null),U=x(null),A=()=>{o.content=S.value.getHTML(),console.log(o.content),o.post(route("emails.store-reply",h.email.id)),o.reset()},N=()=>{let s=L.value.files[0];if($(s)){let u=new FileReader;u.readAsDataURL(s),u.onload=()=>{o.files.push({file:s,preview:u.result,is_image:!0})}}else o.files.push({file:s,preview:null,is_image:!1})},q=()=>{let s=U.value.files[0];if($(s)){let u=new FileReader;u.readAsDataURL(s),u.onload=()=>{o.files.push({file:s,preview:u.result,is_image:!0})}}else o.files.push({file:s,preview:null,is_image:!1})},C=s=>{o.files.splice(s,1)},$=s=>s?["image/jpeg","image/png","image/gif","image/jpg"].includes(s.type):!1,O=s=>{o.reply_to=s,v.value=!0},T=x(null),z=s=>{T.value=T.value===s?null:s},E=()=>{if(w.value=!w.value,w.value){v.value=!1,o.subject="Fwd: "+h.email.subject;let s=h.email.messages[h.email.messages.length-1],u="---------- Forwarded message ---------<br>From: "+s.sender.name+" < "+s.sender.email+" ><br>Date: "+s.created_at+" <br>Subject: "+h.email.subject+" <br>To: "+(s.reply_message==null?h.email.receivers.map(l=>l.user.name+" < "+l.user.email+" >").join(", "):s.reply_message.sender.name+" <"+s.reply_message.sender.email+">")+"<br><br>"+h.email.messages.map(l=>l.content).join("<br>");console.log(u),F.value.setHTML(u)}},K=()=>{o.receivers.push(j.value),j.value=null},P=s=>{o.receivers.splice(s,1)},Z=()=>{o.message=F.value.getHTML(),o.post(route("forward"))},k=x({}),G=s=>{k.value[s]=!k.value[s]};return(s,u)=>(n(),i(m,null,[a(t(X),{title:"Details"}),a(se,null,{default:B(()=>[e("div",ie,[e("div",ae,[e("div",re,[e("div",ce,[a(t(Y),{href:s.route("inbox"),class:"w-9 h-9 bg-gray-100 text-gray-600 flex items-center justify-center rounded-full"},{default:B(()=>[a(t(d),{icon:"bi:arrow-left"})]),_:1},8,["href"])])])]),e("div",de,[e("h2",ue,r(h.email.subject),1),pe]),(n(!0),i(m,null,g(y.email.messages,(l,c)=>(n(),i("div",{key:y.email.id,class:"px-5 py-4 mb-4 border-b last:border-none"},[e("div",{onClick:p=>G(c),class:"flex md:items-center justify-between flex-col sm:flex-row cursor-pointer"},[e("div",fe,[a(oe,{class:"w-12 h-12 rounded-full border border-black shrink-0"}),e("div",xe,[e("h4",he,r(l.sender.name),1),k.value[c]?(n(),i("div",_e,[be,e("span",null,r(l.reply_message==null?"all":l.reply_message.sender.name),1),e("div",ve,[e("button",{class:"text-2xl p-0",onClick:b(p=>z(l.id),["stop"])},[a(t(d),{icon:"ri:arrow-drop-down-fill"})],8,ge),T.value===l.id?(n(),i("div",ye,[e("ul",null,[e("li",we,[ke,_(" "+r(l.sender.name),1)]),e("li",je,[Ce,e("div",Fe,[(n(!0),i(m,null,g(y.email.receivers,p=>(n(),i(m,{key:p.id},[p.user.email!==s.$page.props.auth.user.email?(n(),i("span",Te,[e("span",null,r(p.user.name),1),e("span",Me," <"+r(p.user.email)+">",1)])):f("",!0)],64))),128))])]),e("li",Se,[Ie,_(" "+r(l.created_at),1)]),e("li",Re,[Le,_(" "+r(y.email.subject),1)]),e("li",Ue,[$e,_(" "+r(y.email.from.email.split("@")[1]),1)])])])):f("",!0)])])):f("",!0),k.value[c]?f("",!0):(n(),i("span",{key:1,class:"minimized-text text-slate-600 text-sm",innerHTML:l.content},null,8,Be))])]),e("div",De,[e("p",He,r(l.created_at),1),e("div",Ve,[e("button",Qe,[a(t(d),{icon:"tabler:star"})])]),e("div",Ae,[e("button",{onClick:b(p=>O(l.id),["stop"]),class:"w-9 h-9 bg-gray-100 text-gray-600 flex items-center justify-center rounded-full"},[a(t(d),{icon:"material-symbols:reply"})],8,Ne),qe])])],8,me),k.value[c]?(n(),i("div",Oe,[e("span",{innerHTML:l.content},null,8,ze),l.attachments&&l.attachments.length>0?(n(),i("div",Ee,[(n(!0),i(m,null,g(l.attachments,p=>(n(),i("div",{key:p.id,class:"flex items-center justify-center flex-col w-[100px] h-[100px] text-center border p-1 rounded-md relative group"},[e("a",{href:p.original_url,target:"__blank",class:"absolute top-0 right-0 bg-gray-700 text-white rounded-full p-1 hover:bg-gray-800 focus:outline-none transition duration-300 ease-in-out"},[a(t(d),{icon:"tabler:download",class:"w-4 h-4"})],8,Ke),a(t(d),{icon:"mdi:file",class:"w-9 h-9"}),e("span",Pe,r(p.file_name),1)]))),128))])):f("",!0)])):f("",!0)]))),128)),e("div",Ze,[e("button",{onClick:V,class:"border border-[#747775] text-[#444746] font-semibold px-8 py-2 rounded-full bg-white hover:bg-slate-200 transition-all duration-500 text-sm flex items-center"},[a(t(d),{icon:"material-symbols:reply",class:"mr-1 text-base"}),_(" Reply ")]),e("button",{onClick:E,class:"border border-[#747775] text-[#444746] font-semibold px-8 py-2 rounded-full bg-white hover:bg-slate-200 transition-all duration-500 text-sm flex items-center"},[a(t(d),{icon:"solar:forward-outline",class:"mr-1 text-base"}),_(" Forward ")])]),v.value&&w.value===!1?(n(),i("div",Ge,[e("form",{onSubmit:b(A,["prevent"]),class:"p-3 flex flex-col justify-between gap-0"},[e("div",Je,[a(t(H),{ref_key:"quillContent",ref:S,modules:I,toolbar:R},null,512),t(o).errors.content?(n(),i("span",We,r(t(o).errors.content),1)):f("",!0)]),e("div",Xe,[e("div",Ye,[(n(!0),i(m,null,g(t(o).files,(l,c)=>(n(),i("div",{key:c},[l.is_image?(n(),i(m,{key:0},[e("img",{src:l.preview,alt:"File Preview",class:"w-[100px] h-[100px] border rounded"},null,8,et),e("button",{onClick:b(C,["prevent"]),class:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 focus:outline-none transition duration-300 ease-in-out"},[a(t(d),{icon:"ic:round-close",class:"w-4 h-4"})])],64)):(n(),i("div",tt,[e("button",{onClick:b(p=>C(c),["prevent"]),class:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 focus:outline-none transition duration-300 ease-in-out"},[a(t(d),{icon:"ic:round-close",class:"w-4 h-4"})],8,st),a(t(d),{icon:"mdi:file",class:"w-9 h-9"}),e("span",lt,r(l.file.name),1)]))]))),128))])]),e("div",ot,[e("div",null,[nt,e("input",{ref_key:"replyFileInput",ref:U,type:"file",onChange:q,id:"reply-file-upload",class:"hidden"},null,544)]),e("button",it,[_("Send "),a(t(d),{icon:"carbon:send-filled"})])])],32)])):f("",!0),M(e("div",at,[e("div",rt,[e("div",ct,[e("div",dt,[ut,(n(!0),i(m,null,g(t(o).receivers,(l,c)=>(n(),i("div",{key:c,class:"flex items-center bg-gray-200 p-1 rounded-full"},[e("span",pt,r(l),1),e("button",{onClick:b(p=>P(c),["prevent"]),class:"text-red-500"},[a(t(d),{icon:"ic:round-close",class:"w-4 h-4"})],8,mt)]))),128)),M(e("input",{"onUpdate:modelValue":u[0]||(u[0]=l=>j.value=l),onKeyup:te(K,["enter"]),type:"text",placeholder:"Add recipient",class:"flex-grow border-none focus:ring-0 focus:shadow-none focus:border-none outline-none"},null,544),[[D,j.value]]),a(ne,{message:t(o).errors.receivers},null,8,["message"]),(n(!0),i(m,null,g(t(o).receivers,(l,c)=>(n(),i(m,{key:c},[t(o).errors[`receivers.${c}`]?(n(),i("span",ft,r(t(o).receivers[c]+"is not a valid employee email"),1)):f("",!0)],64))),128))]),e("div",xt,[ht,M(e("input",{"onUpdate:modelValue":u[1]||(u[1]=l=>t(o).subject=l),type:"text",class:"w-full block border-none focus:ring-0 focus:shadow-none focus:border-none"},null,512),[[D,t(o).subject]]),t(o).errors.subject?(n(),i("span",_t,r(t(o).errors.subject),1)):f("",!0)])]),e("div",bt,[a(t(H),{ref_key:"forwardQuillContent",ref:F,modules:I,toolbar:R},null,512),t(o).errors.content?(n(),i("span",vt,r(t(o).errors.content),1)):f("",!0)]),e("div",gt,[e("div",yt,[(n(!0),i(m,null,g(t(o).files,(l,c)=>(n(),i("div",{key:c},[l.is_image?(n(),i(m,{key:0},[e("img",{src:l.preview,alt:"File Preview",class:"w-[100px] h-[100px] border rounded"},null,8,wt),e("button",{onClick:b(C,["prevent"]),class:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 focus:outline-none transition duration-300 ease-in-out"},[a(t(d),{icon:"ic:round-close",class:"w-4 h-4"})])],64)):(n(),i("div",kt,[e("button",{onClick:b(p=>C(c),["prevent"]),class:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 focus:outline-none transition duration-300 ease-in-out"},[a(t(d),{icon:"ic:round-close",class:"w-4 h-4"})],8,jt),a(t(d),{icon:"mdi:file",class:"w-9 h-9"}),e("span",Ct,r(l.file.name),1)]))]))),128))])]),e("div",Ft,[e("div",null,[Tt,e("input",{ref_key:"fileInput",ref:L,type:"file",onChange:N,id:"file-upload",class:"hidden"},null,544)]),e("button",{onClick:Z,class:"px-9 py-2 w-[130px] bg-sky-800 text-white rounded-3xl inline-flex items-center gap-1",type:"submit"},[_(" Send "),a(t(d),{icon:"carbon:send-filled"})])])])],512),[[ee,w.value&v.value===!1]])])]),_:1})],64))}};export{Lt as default};
